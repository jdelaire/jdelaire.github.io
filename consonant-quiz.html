
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="description" content="Learn Thai consonants through an interactive quiz. Practice all 44 Thai consonants with pronunciation and meanings.">
  <meta name="keywords" content="Thai, consonants, alphabet, quiz, learning, language">
  <meta name="author" content="Thai Consonant Quiz">
  <title>Thai Consonant Quiz</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      text-align: center;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      padding: 2em;
      margin: 0;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      color: white;
    }
    h1 {
      color: white;
      margin-bottom: 0.5em;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    }
    #symbol {
      font-size: 10em;
      margin: 0.5em 0 1em 0;
      font-weight: bold;
      color: white;
      text-shadow: 3px 3px 6px rgba(0,0,0,0.3);
    }
    .options {
      display: flex;
      flex-direction: column;
      gap: 1em;
      max-width: 300px;
      margin: 0 auto;
    }
    button {
      padding: 1em;
      font-size: 1.3em;
      cursor: pointer;
      border: 2px solid rgba(255, 255, 255, 0.3);
      background: rgba(255, 255, 255, 0.1);
      color: white;
      border-radius: 15px;
      transition: all 0.3s ease;
      font-weight: 500;
      backdrop-filter: blur(10px);
    }
    button:hover {
      background: rgba(255, 255, 255, 0.2);
      color: white;
      transform: translateY(-3px);
      box-shadow: 0 10px 20px rgba(0,0,0,0.2);
    }
    button:active {
      transform: translateY(0);
    }
    button .emoji {
      font-size: 1.5em;
      margin-right: 0.3em;
    }
    .middle-class {
      border-color: #27ae60 !important;
      background-color: #27ae60 !important;
      color: white !important;
    }
    .middle-class:hover {
      background-color: #229954 !important;
      color: white !important;
      transform: translateY(-3px);
      box-shadow: 0 10px 20px rgba(39, 174, 96, 0.3);
    }
    .high-class {
      border-color: #f39c12 !important;
      background-color: #f39c12 !important;
      color: white !important;
    }
    .high-class:hover {
      background-color: #e67e22 !important;
      color: white !important;
      transform: translateY(-3px);
      box-shadow: 0 10px 20px rgba(243, 156, 18, 0.3);
    }
    .low-class {
      border-color: #3498db !important;
      background-color: #3498db !important;
      color: white !important;
    }
    .low-class:hover {
      background-color: #2980b9 !important;
      color: white !important;
      transform: translateY(-3px);
      box-shadow: 0 10px 20px rgba(52, 152, 219, 0.3);
    }
    .legend {
      display: flex;
      justify-content: center;
      gap: 1.5em;
      margin-bottom: 0.5em;
      font-size: 0.9em;
      color: white;
    }
    .legend-item {
      display: flex;
      align-items: center;
      gap: 0.3em;
    }
    .legend-color {
      width: 1em;
      height: 1em;
      border-radius: 50%;
      display: inline-block;
    }
    .legend-color.middle-class {
      background-color: #27ae60;
    }
    .legend-color.high-class {
      background-color: #f39c12;
    }
    .legend-color.low-class {
      background-color: #3498db;
    }
    .controls {
      display: flex;
      justify-content: center;
      margin-bottom: 1em;
    }
    .sound-toggle {
      background: rgba(255, 255, 255, 0.2);
      color: white;
      border: 1px solid rgba(255, 255, 255, 0.3);
      padding: 0.5em 1em;
      border-radius: 20px;
      font-size: 0.9em;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 500;
      backdrop-filter: blur(10px);
    }
    .sound-toggle:hover {
      background: rgba(255, 255, 255, 0.3);
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    }
    .sound-toggle.off {
      background: rgba(255, 255, 255, 0.1);
      opacity: 0.7;
    }
    .sound-toggle.off:hover {
      background: rgba(255, 255, 255, 0.15);
      opacity: 0.9;
    }
    .voice-select {
      margin-left: 1em;
      padding: 0.5em;
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 8px;
      font-size: 0.9em;
      background: rgba(255, 255, 255, 0.1);
      color: white;
      backdrop-filter: blur(10px);
    }
    .voice-select:focus {
      outline: none;
      border-color: rgba(255, 255, 255, 0.5);
    }
    .voice-select option {
      background: #764ba2;
      color: white;
    }
    #feedback {
      margin-top: 1em;
      font-size: 1.3em;
      font-weight: bold;
      min-height: 1.5em;
      color: white;
    }
    #nextBtn {
      margin-top: 2em;
      padding: 0.8em 2em;
      font-size: 1.1em;
      display: none;
      background: linear-gradient(45deg, #27ae60, #2ecc71);
      color: white;
      border: none;
      border-radius: 15px;
      font-weight: bold;
      transition: all 0.3s ease;
    }
    #nextBtn:hover {
      background: linear-gradient(45deg, #229954, #27ae60);
      transform: translateY(-2px);
      box-shadow: 0 10px 20px rgba(0,0,0,0.2);
    }
    .stats {
      margin-top: 2em;
      font-size: 0.9em;
      color: rgba(255, 255, 255, 0.8);
    }
    .header {
      position: relative;
      margin-bottom: 1em;
    }
    .back-btn {
      position: absolute;
      left: 0;
      top: 50%;
      transform: translateY(-50%);
      color: white;
      text-decoration: none;
      padding: 0.5em 1em;
      border-radius: 20px;
      background: rgba(255, 255, 255, 0.2);
      border: 1px solid rgba(255, 255, 255, 0.3);
      transition: all 0.3s ease;
      font-size: 0.9em;
      backdrop-filter: blur(10px);
    }
    .back-btn:hover {
      background: rgba(255, 255, 255, 0.3);
      transform: translateY(-50%) translateX(-2px);
      box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    }
    @media (max-width: 600px) {
      body {
        padding: 0.5em;
        min-height: 100vh;
      }
      h1 {
        font-size: 1.5em;
        margin-bottom: 0.3em;
      }
      #symbol {
        font-size: 7em;
        margin: 0.3em 0 0.8em 0;
      }
      .legend {
        gap: 1em;
        margin-bottom: 0.3em;
        font-size: 0.8em;
        flex-wrap: wrap;
        justify-content: center;
      }
      .options {
        max-width: 100%;
        gap: 0.8em;
      }
      button {
        font-size: 1em;
        padding: 0.7em;
        min-height: 3em;
      }
      button .emoji {
        font-size: 1.3em;
      }
      #feedback {
        font-size: 1.2em;
        margin-top: 0.8em;
      }
      #nextBtn {
        margin-top: 1.5em;
        padding: 0.7em 1.5em;
      }
      .stats {
        margin-top: 1.5em;
        font-size: 0.8em;
      }
      .controls {
        margin-bottom: 0.5em;
      }
      .sound-toggle {
        font-size: 0.8em;
        padding: 0.4em 0.8em;
      }
      .voice-select {
        font-size: 0.8em;
        margin-left: 0.5em;
        max-width: 150px;
      }
    }
    
    @media (max-width: 400px) {
      #symbol {
        font-size: 6em;
      }
      .legend {
        flex-direction: column;
        gap: 0.5em;
      }
      button {
        font-size: 0.9em;
        padding: 0.6em;
      }
    }
  </style>
</head>
<body>
  <div class="header">
    <a href="index.html" class="back-btn">‚Üê Back to Home</a>
    <h1>Thai Consonant Quiz</h1>
  </div>
  <div class="controls">
    <button id="soundToggle" class="sound-toggle off" aria-label="Toggle sound">
      üîá Sound Off
    </button>
    <select id="voiceSelect" class="voice-select" aria-label="Select voice">
      <option value="">Loading voices...</option>
    </select>
  </div>
  <div class="legend">
    <span class="legend-item"><span class="legend-color middle-class"></span> Middle Class</span>
    <span class="legend-item"><span class="legend-color high-class"></span> High Class</span>
    <span class="legend-item"><span class="legend-color low-class"></span> Low Class</span>
  </div>
  <div id="symbol" role="text" aria-label="Thai consonant symbol">?</div>
  <div class="options" id="options" role="group" aria-label="Answer options"></div>
  <div id="feedback" role="status" aria-live="polite"></div>
  <button id="nextBtn" aria-label="Next question">Next</button>
  <div class="stats" id="stats"></div>

  <script>
    const data = JSON.parse(`[
  {
    "symbol": "‡∏Å",
    "name": "g…î…î g√†i",
    "meaning": "chicken",
    "emoji": "üêî",
    "class": "middle"
  },
  {
    "symbol": "‡∏Ç",
    "name": "kh…îÃå…î kh√†i",
    "meaning": "egg",
    "emoji": "ü•ö",
    "class": "high"
  },
  {
    "symbol": "‡∏É",
    "name": "kh…îÃå…î kh√πat",
    "meaning": "bottle",
    "emoji": "üçæ",
    "class": "high"
  },
  {
    "symbol": "‡∏Ñ",
    "name": "kh…î…î khwaay",
    "meaning": "water buffalo",
    "emoji": "üêÉ",
    "class": "low"
  },
  {
    "symbol": "‡∏Ö",
    "name": "kh…î…î khon",
    "meaning": "human",
    "emoji": "üë§",
    "class": "low"
  },
  {
    "symbol": "‡∏Ü",
    "name": "kh…î…î r√°-kha≈ã",
    "meaning": "bell",
    "emoji": "üîî"
  },
  {
    "symbol": "‡∏á",
    "name": "≈ã…î…î ≈ãuu",
    "meaning": "snake",
    "emoji": "üêç"
  },
  {
    "symbol": "‡∏à",
    "name": "j…î…î jaan",
    "meaning": "plate",
    "emoji": "üçΩÔ∏è",
    "class": "middle"
  },
  {
    "symbol": "‡∏â",
    "name": "ch…îÃå…î ch√¨≈ã",
    "meaning": "cymbal",
    "emoji": "ü•Å",
    "class": "high"
  },
  {
    "symbol": "‡∏ä",
    "name": "ch…î…î ch√°a≈ã",
    "meaning": "elephant",
    "emoji": "üêò",
    "class": "low"
  },
  {
    "symbol": "‡∏ã",
    "name": "s…î…î s√¥o",
    "meaning": "chain",
    "emoji": "‚õìÔ∏è",
    "class": "low"
  },
  {
    "symbol": "‡∏å",
    "name": "ch…î…î ch…ô…ô",
    "meaning": "name of tree",
    "emoji": "üå≥",
    "class": "low"
  },
  {
    "symbol": "‡∏ç",
    "name": "y…î…î ph√ªu y«ê≈ã",
    "meaning": "female",
    "emoji": "üë©",
    "class": "low"
  },
  {
    "symbol": "‡∏é",
    "name": "d…î…î ch√°-daa",
    "meaning": "head dress",
    "emoji": "üëë",
    "class": "middle"
  },
  {
    "symbol": "‡∏è",
    "name": "dt…î…î bp√†-dt√†k",
    "meaning": "lance",
    "emoji": "‚öîÔ∏è",
    "class": "middle"
  },
  {
    "symbol": "‡∏ê",
    "name": "th…îÃå…î th…ëÃå…ën",
    "meaning": "pedestal",
    "emoji": "üèõÔ∏è",
    "class": "high"
  },
  {
    "symbol": "‡∏ë",
    "name": "th…î…î mon-thoo",
    "meaning": "Lady Montho",
    "emoji": "üë∏",
    "class": "low"
  },
  {
    "symbol": "‡∏í",
    "name": "th…î…î ph√ªu-th√¢w",
    "meaning": "elderly",
    "emoji": "üë¥",
    "class": "low"
  },
  {
    "symbol": "‡∏ì",
    "name": "n…î…î neen",
    "meaning": "novice",
    "emoji": "üßò",
    "class": "low"
  },
  {
    "symbol": "‡∏î",
    "name": "d…î…î d√®k",
    "meaning": "child",
    "emoji": "üë∂",
    "class": "middle"
  },
  {
    "symbol": "‡∏ï",
    "name": "dt…î…î dt√†w",
    "meaning": "turtle",
    "emoji": "üê¢",
    "class": "middle"
  },
  {
    "symbol": "‡∏ñ",
    "name": "th…îÃå…î th≈≠≈ã",
    "meaning": "bag",
    "emoji": "üëú",
    "class": "high"
  },
  {
    "symbol": "‡∏ó",
    "name": "th…î…î th√°-h…ëÃåan",
    "meaning": "soldier",
    "emoji": "üíÇ",
    "class": "low"
  },
  {
    "symbol": "‡∏ò",
    "name": "th…î…î tho≈ã",
    "meaning": "flag",
    "emoji": "üáπüá≠",
    "class": "low"
  },
  {
    "symbol": "‡∏ô",
    "name": "n…î…î n«îu",
    "meaning": "mouse",
    "emoji": "üê≠",
    "class": "low"
  },
  {
    "symbol": "‡∏ö",
    "name": "b…î…î bai-m√°ay",
    "meaning": "leaf",
    "emoji": "üçÉ",
    "class": "middle"
  },
  {
    "symbol": "‡∏õ",
    "name": "bp…î…î bplaa",
    "meaning": "fish",
    "emoji": "üêü",
    "class": "middle"
  },
  {
    "symbol": "‡∏ú",
    "name": "ph…îÃå…î ph…ØÃÇ≈ã",
    "meaning": "bee",
    "emoji": "üêù",
    "class": "high"
  },
  {
    "symbol": "‡∏ù",
    "name": "f…îÃå…î fƒÉa",
    "meaning": "lid/cover",
    "emoji": "üîí",
    "class": "high"
  },
  {
    "symbol": "‡∏û",
    "name": "ph…î…î phaan",
    "meaning": "offering tray",
    "emoji": "üèÜ",
    "class": "low"
  },
  {
    "symbol": "‡∏ü",
    "name": "f…î…î fan",
    "meaning": "tooth",
    "emoji": "ü¶∑",
    "class": "low"
  },
  {
    "symbol": "‡∏†",
    "name": "ph…î…î sƒÉm-phaw",
    "meaning": "junk",
    "emoji": "üö¢",
    "class": "low"
  },
  {
    "symbol": "‡∏°",
    "name": "m…î…î m√°a",
    "meaning": "horse",
    "emoji": "üêé",
    "class": "low"
  },
  {
    "symbol": "‡∏¢",
    "name": "y…î…î y√°k",
    "meaning": "giant",
    "emoji": "üëπ",
    "class": "high"
  },
  {
    "symbol": "‡∏£",
    "name": "r…î…î r…Øa",
    "meaning": "boat",
    "emoji": "üö£",
    "class": "low"
  },
  {
    "symbol": "‡∏•",
    "name": "l…î…î li≈ã",
    "meaning": "monkey",
    "emoji": "üêí",
    "class": "low"
  },
  {
    "symbol": "‡∏ß",
    "name": "w…î…î w…õÃå…õn",
    "meaning": "ring",
    "emoji": "üíç",
    "class": "low"
  },
  {
    "symbol": "‡∏®",
    "name": "s…îÃå…î s«éa-laa",
    "meaning": "pavilion",
    "emoji": "üèõÔ∏è",
    "class": "high"
  },
  {
    "symbol": "‡∏©",
    "name": "s…îÃå…î r…Ø…Ø-s«êi",
    "meaning": "hermit",
    "emoji": "üßô",
    "class": "high"
  },
  {
    "symbol": "‡∏™",
    "name": "s…îÃå…î s…ØÃåa",
    "meaning": "tiger",
    "emoji": "üêØ",
    "class": "high"
  },
  {
    "symbol": "‡∏´",
    "name": "h…îÃå…î h√¨ip",
    "meaning": "treasure chest",
    "emoji": "üíé",
    "class": "high"
  },
  {
    "symbol": "‡∏¨",
    "name": "l…î…î j√π-laa",
    "meaning": "kite",
    "emoji": "ü™Å",
    "class": "low"
  },
  {
    "symbol": "‡∏≠",
    "name": "…î…î √†a≈ã",
    "meaning": "basin",
    "emoji": "üõÅ",
    "class": "middle"
  },
  {
    "symbol": "‡∏Æ",
    "name": "h…î…î n√≥k-h√ªuk",
    "meaning": "owl",
    "emoji": "ü¶â",
    "class": "low"
  }
]`);

    const symbolEl = document.getElementById('symbol');
    const optionsEl = document.getElementById('options');
    const feedbackEl = document.getElementById('feedback');
    const nextBtn = document.getElementById('nextBtn');
    const statsEl = document.getElementById('stats');
    const soundToggle = document.getElementById('soundToggle');
    const voiceSelect = document.getElementById('voiceSelect');

    let currentAnswer = null;
    let questionsAnswered = 0;
    let correctAnswers = 0;
    let soundEnabled = false;
    let speechSynth = window.speechSynthesis;
    let selectedVoice = null;

    function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    }

    function updateStats() {
      const accuracy = questionsAnswered > 0 ? Math.round((correctAnswers / questionsAnswered) * 100) : 0;
      statsEl.textContent = `Questions: ${questionsAnswered} | Correct: ${correctAnswers} | Accuracy: ${accuracy}%`;
    }

    function speak(text, rate = 0.8) {
      if (!soundEnabled || !speechSynth) return;
      
      // Clean the text to ensure it only contains pronunciation
      // Remove any non-letter characters except spaces and basic punctuation
      const cleanText = text.replace(/[^\w\s\u0300-\u036f\u00E0-\u00FF]/g, '').trim();
      
      console.log('Speaking:', cleanText);
      
      // Cancel any ongoing speech
      speechSynth.cancel();
      
      const utterance = new SpeechSynthesisUtterance(cleanText);
      utterance.lang = 'th-TH';
      utterance.rate = rate;
      utterance.pitch = 1;
      utterance.volume = 0.8;
      
      // Wait for voices to load if they haven't already
      if (speechSynth.getVoices().length === 0) {
        speechSynth.onvoiceschanged = () => {
          selectBestVoice(utterance);
          speechSynth.speak(utterance);
        };
      } else {
        selectBestVoice(utterance);
        speechSynth.speak(utterance);
      }
    }

    function populateVoiceSelector() {
      const voices = speechSynth.getVoices();
      voiceSelect.innerHTML = '';
      
      if (voices.length === 0) {
        voiceSelect.innerHTML = '<option value="">No voices available</option>';
        return;
      }
      
      // Add default option
      const defaultOption = document.createElement('option');
      defaultOption.value = '';
      defaultOption.textContent = 'Auto-select best voice';
      voiceSelect.appendChild(defaultOption);
      
      // Add all available voices
      voices.forEach((voice, index) => {
        const option = document.createElement('option');
        option.value = index;
        option.textContent = `${voice.name} (${voice.lang})`;
        voiceSelect.appendChild(option);
      });
      
      // Auto-select Thai voice if available
      const thaiVoice = voices.find(voice => 
        voice.lang.toLowerCase().includes('th') ||
        voice.name.toLowerCase().includes('thai')
      );
      if (thaiVoice) {
        const thaiIndex = voices.indexOf(thaiVoice);
        voiceSelect.value = thaiIndex;
        selectedVoice = thaiVoice;
      }
    }

    function selectBestVoice(utterance) {
      const voices = speechSynth.getVoices();
      
      if (selectedVoice) {
        utterance.voice = selectedVoice;
        return;
      }
      
      // Priority order for Thai voices
      const thaiVoicePatterns = [
        'th-TH',
        'th',
        'Thai',
        'thai'
      ];
      
      let bestVoice = null;
      
      // Try to find the best Thai voice
      for (const pattern of thaiVoicePatterns) {
        bestVoice = voices.find(voice => 
          voice.lang.toLowerCase().includes(pattern.toLowerCase()) ||
          voice.name.toLowerCase().includes(pattern.toLowerCase())
        );
        if (bestVoice) break;
      }
      
      // If no Thai voice found, try to find a female voice (often better for Thai)
      if (!bestVoice) {
        bestVoice = voices.find(voice => 
          voice.name.toLowerCase().includes('female') ||
          voice.name.toLowerCase().includes('woman')
        );
      }
      
      // Fallback to any available voice
      if (!bestVoice && voices.length > 0) {
        bestVoice = voices[0];
      }
      
      if (bestVoice) {
        utterance.voice = bestVoice;
        console.log('Using voice:', bestVoice.name, bestVoice.lang);
      }
    }

    function toggleSound() {
      soundEnabled = !soundEnabled;
      soundToggle.textContent = soundEnabled ? 'üîä Sound On' : 'üîá Sound Off';
      soundToggle.classList.toggle('off', !soundEnabled);
    }

    function pickQuestion() {
      feedbackEl.textContent = "";
      nextBtn.style.display = "none";
      optionsEl.innerHTML = "";

      const answer = data[Math.floor(Math.random() * data.length)];
      currentAnswer = answer;

      const choices = [answer];
      while (choices.length < 4) {
        const rand = data[Math.floor(Math.random() * data.length)];
        if (!choices.find(c => c.name === rand.name)) choices.push(rand);
      }

      shuffle(choices);
      symbolEl.textContent = answer.symbol;
      symbolEl.setAttribute('aria-label', `Thai consonant symbol: ${answer.symbol}`);

      choices.forEach(choice => {
        const btn = document.createElement('button');
        btn.innerHTML = `<span class="emoji">${choice.emoji}</span> ${choice.name}`;
        btn.setAttribute('aria-label', `Answer: ${choice.name} (${choice.meaning})`);
        btn.classList.add(`${choice.class}-class`);
        btn.onclick = () => {
          // Speak only the pronunciation text (not the emoji)
          console.log('Choice name:', choice.name);
          speak(choice.name);
          
          questionsAnswered++;
          if (choice.name === answer.name) {
            correctAnswers++;
            feedbackEl.textContent = "‚úÖ Correct!";
            nextBtn.style.display = "inline-block";
          } else {
            feedbackEl.textContent = "‚ùå Try again!";
          }
          updateStats();
        };
        optionsEl.appendChild(btn);
      });
    }

    // Sound toggle event listener
    soundToggle.addEventListener('click', toggleSound);
    
    // Voice selection event listener
    voiceSelect.addEventListener('change', (e) => {
      const voices = speechSynth.getVoices();
      const selectedIndex = e.target.value;
      
      if (selectedIndex === '') {
        selectedVoice = null; // Use auto-selection
      } else {
        selectedVoice = voices[parseInt(selectedIndex)];
      }
    });

    // Keyboard navigation
    document.addEventListener('keydown', (e) => {
      if (e.key >= '1' && e.key <= '4') {
        const buttons = optionsEl.querySelectorAll('button');
        const index = parseInt(e.key) - 1;
        if (buttons[index]) {
          buttons[index].click();
        }
      } else if (e.key === 'Enter' && nextBtn.style.display !== 'none') {
        nextBtn.click();
      }
    });

    nextBtn.onclick = pickQuestion;

    // Initialize
    pickQuestion();
    updateStats();
    
    // Initialize voice selector
    if (speechSynth.getVoices().length === 0) {
      speechSynth.onvoiceschanged = populateVoiceSelector;
    } else {
      populateVoiceSelector();
    }
  </script>
</body>
</html>
